
<h3 style="margin: 0px;">
	<i class="icon-resize-small"></i> External Short Messaging Entities
</h3>
<hr style="margin: 10 0px;" />
<span style="float: right;">
	<button id="refresh" style="float: right; margin-right: 20px; margin-left: 20px; height: 30px;" class="btn btn-medium btn-success" data-toggle="tooltip" data-placement="left" title="Refresh ESME List" onclick="updateEsmes();">
		<i class="icon-refresh"></i>
	</button>
</span>
<span id="esmes-table-wrapper">
	<table id="no-esmes-table" class="table" style="display: none;">
		<tr>
			<td>
				<div class="alert alert-info fade in">
					<strong>No ESME!</strong> 
				</div>
			</td>
		</tr>
	</table>

	<table id="esmes-table" class="table table-hover">
		<thead>
			<tr>
				<th style="width: 30px;">&nbsp;</th>
				<th>Name</th>
				<th>SystemId</th>
				<th>Type</th>
				<th>State</th>
				<th style="text-align: center; width: 150px;">Actions</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	<p>
		<a href="#entities-modal" role="button" class="btn btn-info btn-small" data-toggle="modal" ><i class="icon-external-link"></i> Create ESME</a>
	</p>	
</span>

<div id="entities-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Create ESME</h3>
	</div>
	<div id="entities-modal-body" class="modal-body">
		<div class="alert alert-error" id="login-settings-error" style="display:none;">
		  <button type="button" class="close">&times;</button>
		  Some Fields are not correctly filled out, please double check the settings below !
		</div>
		<p>
			<span>
				<div id="div-esmeName" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="unique name for this ESME">
						<span class="add-on">ESME Name</span>
						<input id="esmeName" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="ESME Name" />
					</span>				
				</div>
				
				<div id="div-systemId" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="is used to identify an ESME or an SMSC at bind time. An ESME system_id identifies the ESME or ESME agent to the SMSC. The SMSC system_id provides an identification of the SMSC to the ESME.">
						<span class="add-on">System Id</span>
						<input id="systemId" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="System Id" />
					</span>								
				</div>
				
				<div id="div-password" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="is used by the SMSC to authenticate the identity of the binding ESME. The Service Provider may require ESMEâ€™s to provide a password when binding to the SMSC">
						<span class="add-on">Password</span>
						<input id="password" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Password" />
					</span>					
				</div>
				
				<div id="div-ipAddress" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="if SMSC is acting as ESME, the BIND request will be sent to configured ip and port. If SMSC is acting as Server, it will accept incoming BIND request from specified IP and Port. If port is unknown, pass -1 as willd character">
						<span class="add-on">IP Address</span>
						<input id="ipAddress" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="IP Address" />
					</span>					
				</div>
				
				<div id="div-ipPort" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="if SMSC is acting as ESME, the BIND request will be sent to configured ip and port. If SMSC is acting as Server, it will accept incoming BIND request from specified IP and Port. If port is unknown, pass -1 as willd character">
						<span class="add-on">Port</span>
						<input id="ipPort" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Port" />
					</span>	
				</div>
				
				<div id="div-smppBindTypeBtnGrp" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="if SMSC is acting as ESME, it will initiate corresponding bind else if its server it will accept corresponding bind from remote ESME">
						<span class="add-on">Smpp Bind Type</span>
						<select id="smppBindType" >
							<option>TRANSCEIVER</option>
							<option>TRANSMITTER</option>
							<option>RECEIVER</option>
						</select>
					</span>
				</div>

				<div id="div-smppSessionTypeBtnGrp" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="if SERVER, SMSC acts as server listening for incoming SMPP binds. If CLIENT, SMSC will initiate SMPP bind to remote server">
						<span class="add-on">Smpp Session Type</span>
						<select id="smppSessionType" onchange="clientServerFunction()">
							<option>CLIENT</option>
							<option>SERVER</option>
						</select>
					</span>
				</div>
				
				<div id="div-chargingEnabledBtnGrp" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="if charging is enabled for this ESME. The 'ESME Originated SMS Charged' property should be 'Selected' for this setting to take effect">
						<span class="add-on">Charging Enabled</span>
						<select id="chargingEnabled" >
							<option>False</option>
							<option>True</option>
						</select>
					</span>
				</div>				

				<div id="div-systemType" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="is used to categorize the type of ESME that is binding to the SMSC">
						<span class="add-on">System Type</span>
						<input id="systemType" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="System Type" />
					</span>	
				</div>
				
				<div id="div-version" class="control-group">		
				
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="indicate the version of the SMPP protocol">
						<span class="add-on">Version</span>
						<select id="version" >
							<option>3.3</option>
							<option selected="selected">3.4</option>
							<option>5.0</option>
						</select>
					</span>
				</div>
				
				<div id="div-esmeTon" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="defines ESME TON. if SMPP Session Type is CLIENT this TON will be used in BIND request, if SMPP Session Type is SERVER, incoming BIND request should have same TON as configured here. If configured is null(-1), SMSC will ignore in both the cases">
						<span class="add-on">ESME Type of number (TON)</span>
						<select id="esmeTon" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">International</option>
							<option value="2">National</option>
							<option value="3">Network Specific</option>
							<option value="4">Subscriber Number</option>
							<option value="5">Alphanumeric</option>
							<option value="6">Abbreviated</option>
							<option value="7">Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-esmeNpi" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="defines ESME NPI. if SMPP Session Type is CLIENT this NPI will be used in BIND request, if SMPP Session Type is SERVER, incoming BIND request should have same NPI as configured here. If configured is null(-1), SMSC will ignore in both the cases">
						<span class="add-on">ESME Number plan indicator (NPI)</span>
						<select id="esmeNpi" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">ISDN (E163/E164)</option>
							<option value="3">Data (X.121)</option>
							<option value="4">Telex (F.69)</option>
							<option value="6">Land Mobile (E.212)</option>
							<option value="8">National</option>
							<option value="9">Private</option>
							<option value="10">ERMES</option>
							<option value="14">Internet (IP)</option>
							<option value="18">WAP Client Id</option>
						</select>
					</span>	
				</div>				
				
				<div id="div-esmeRange" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="defines ESME Address Range. if SMPP Session Type is CLIENT this address range will be used in BIND request, if SMPP Session Type is SERVER, incoming BIND request should have same address range as configured here. If configured is null, SMSC will ignore in both the cases">
						<span class="add-on">ESME Range</span>
						<input id="esmeRange" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="ESME Range" value="^[0-9a-zA-Z]*"/>
					</span>	
				</div>
				
				
				<div id="div-sourceTon" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="every SMS coming into SMSC via this ESME should have same source_addr_ton as configured here. If the value here is null(-1) or it's not null and match's, SMSC will compare source_addr_npi and source_addr as mentioned below. If it doesn't match SMSC will reject this SMS with error code 0x0000000A - Invalid Source Address.">
						<span class="add-on">Source Type of number (TON)</span>
						<select id="sourceTon" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">International</option>
							<option value="2">National</option>
							<option value="3">Network Specific</option>
							<option value="4">Subscriber Number</option>
							<option value="5">Alphanumeric</option>
							<option value="6">Abbreviated</option>
							<option value="7">Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-sourceNpi" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="every SMS coming into SMSC via this ESME should have same source_addr_npi as configured here. If the value here is null(-1)or it's not null and match's, SMSC will compare source_addr as mentioned below. If it doesn't match SMSC will reject this SMS with error code 0x0000000A - Invalid Source Address.">
						<span class="add-on">Source Number plan indicator (NPI)</span>
						<select id="sourceNpi" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">ISDN (E163/E164)</option>
							<option value="3">Data (X.121)</option>
							<option value="4">Telex (F.69)</option>
							<option value="6">Land Mobile (E.212)</option>
							<option value="8">National</option>
							<option value="9">Private</option>
							<option value="10">ERMES</option>
							<option value="14">Internet (IP)</option>
							<option value="18">WAP Client Id</option>
						</select>
					</span>	
				</div>				
				
				<div id="div-sourceRange" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="every SMS coming into SMSC via this ESME should have same source_addr as mentioned here. This is regular java expression. Default value is ^[0-9a-zA-Z]* If it match's, SMSC will accept incoming SMS and process further. If it doesn't match SMSC will reject this SMS with error code 0x0000000A - Invalid Source Address.">
						<span class="add-on">Source Range</span>
						<input id="sourceRange" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Source Range" value="^[0-9a-zA-Z]*"/>
					</span>	
				</div>	
				
				<div id="div-routingTon" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="DefaultSmsRoutingRule will try to match the dest_addr_ton of outgoing SMS with one configured here. If configured value is null(-1) or it's not null and match's, SMSC will compare dest_addr_npi and destination_addr as below. It it doesn't match, SMSC will select next ESME in list for matching routing rule">
						<span class="add-on">Routing Type of number (TON)</span>
						<select id="routingTon" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">International</option>
							<option value="2">National</option>
							<option value="3">Network Specific</option>
							<option value="4">Subscriber Number</option>
							<option value="5">Alphanumeric</option>
							<option value="6">Abbreviated</option>
							<option value="7">Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-routingNpi" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="DefaultSmsRoutingRule will try to match the dest_addr_npi with one configured here. If configured value is null(-1)or it's not null and match's, SMSC will compare destination_addr as below. It it doesn't match, SMSC will select next ESME in list for matching routing rule">
						<span class="add-on">Routing Number plan indicator (NPI)</span>
						<select id="routingNpi" >
							<option value="-1">Null</option>
							<option value="0">Unknown</option>
							<option value="1">ISDN (E163/E164)</option>
							<option value="3">Data (X.121)</option>
							<option value="4">Telex (F.69)</option>
							<option value="6">Land Mobile (E.212)</option>
							<option value="8">National</option>
							<option value="9">Private</option>
							<option value="10">ERMES</option>
							<option value="14">Internet (IP)</option>
							<option value="18">WAP Client Id</option>
						</select>
					</span>	
				</div>				
				
				<div id="div-routingRange" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="DefaultSmsRoutingRule will try to match destination_addr here. This is regular java expression. Default value is ^[0-9a-zA-Z]*. If it match's, SMSC will send the SMS out over this SMPP connection. If it doesn't match, SMSC will select next ESME in list for matching routing rule">
						<span class="add-on">Routing Range</span>
						<input id="routingRange" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Routing Range" value="^[0-9a-zA-Z]*"/>
					</span>	
				</div>							
				
	
				<div id="div-clusterName" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="its possible to group different SMPP connections together by specifying same cluster-name. All the SMPP connection 's that are capable of sending out SMS are candidates for grouping ">
						<span class="add-on">Cluster Name</span>
						<input id="clusterName" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Cluster Name" />
					</span>	
				</div>
					
				<div id="div-windowSize" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="window size is the amount of unacknowledged requests that are permitted to be outstanding/unacknowledged at any given time. If more requests are added, underlying stack will throw exception. This value is set only when ESME is defined as Client side. For Server side this value is taken from SMPP Server Setting">
						<span class="add-on">Windows Size</span>
						<input id="windowSize" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Windows Size" value="1"/>
					</span>	
				</div>
													
				<div id="div-connectTimeout" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Time within which the connection to remote SMSCR server should be established. This is useful only when ESME is defined as Client Side. For Server side this value is taken from SMPP Server Setting.">
						<span class="add-on">Connect Timeout</span>
						<input id="connectTimeout" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Connect Timeout" value="10000"/>
					</span>	
				</div>
												
				<div id="div-reqExpTimeout" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Amount of time to wait in milli seconds for an endpoint to respond to before it expires. -1 is disabled. This is useful only when ESME is defined as Client Side. For Server side this value is taken from SMPP Server Setting.">
						<span class="add-on">Request Expiry Timeout</span>
						<input id="reqExpTimeout" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Request Expiry Timeout" value="-1"/>
					</span>	
				</div>
							
				<div id="div-windowMonitorInterval" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Amount of time between executions of monitoring the window for requests that expire. It's recommended that this generally either matches or is half the value of request-expiry-timeout. Therefore, at worst a request would could take up 1.5X the requestExpiryTimeout to clear out. -1 is disabled. This is useful only when ESME is defined as Client Side. For Server side this value is taken from SMPP Server Setting.">
						<span class="add-on">Windows Monitor Interval</span>
						<input id="windowMonitorInterval" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Windows Monitor Interval" value="-1"/>
					</span>	
				</div>
											
				<div id="div-windowWaitTimeout" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Amount of time to wait until a slot opens up in the sendWindow. This is useful only when ESME is defined as Client Side. For Server side this value is taken from SMPP Server Setting.">
						<span class="add-on">Windows Wait Timeout</span>
						<input id="windowWaitTimeout" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Windows Wait Timeout" value="60000"/>
					</span>	
				</div>

				<div id="div-countersEnabled" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="SMSC exposes the statistics for SMPP connections. This is useful only when ESME is defined as Client Side. For Server side this value is taken from SMPP Server Setting.">
						<span class="add-on">Counters Enabled</span>
						<select id="countersEnabled" >
							<option>True</option>
							<option>False</option>
						</select>
					</span>
				</div>

				<div id="div-enqLinkDelay" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="When SMSC connects to remote server as CLIENT, it sends ENQUIRE_LINK every configured enquire-link-delay">
						<span class="add-on">Enquire Link Delay</span>
						<input id="enqLinkDelay" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Enquire Link Delay" value="30000"/>
					</span>	
				</div>
																																																																				
				<button id="add-entity-button" class="btn btn btn-primary" onclick="createEsme()">Create</button>
			</span>
		</p>
		<p>&nbsp;</p>
		<div class="accordion" id="entities-accordion">
		</div>
	</div>
	<div class="modal-footer">
		<a href="#" onclick="$('#entities-modal').modal('hide'); return false;" class="btn">Close</a>
	</div>
</div>

<script type="text/javascript">
	function clientServerFunction(){
		
		var e1 = document.getElementById("smppSessionType");
		var smppSessionType = e1.options[e1.selectedIndex].text;		
		
		if(smppSessionType == "SERVER"){
			document.getElementById("windowSize").disabled = true;
			document.getElementById("connectTimeout").disabled = true;
			document.getElementById("reqExpTimeout").disabled = true;
			document.getElementById("windowMonitorInterval").disabled = true;
			document.getElementById("windowWaitTimeout").disabled = true;
			document.getElementById("countersEnabled").disabled = true;
			document.getElementById("enqLinkDelay").disabled = true;
			
		} else {
			document.getElementById("windowSize").disabled = false;
			document.getElementById("connectTimeout").disabled = false;
			document.getElementById("reqExpTimeout").disabled = false;
			document.getElementById("windowMonitorInterval").disabled = false;
			document.getElementById("windowWaitTimeout").disabled = false;
			document.getElementById("countersEnabled").disabled = false;
			document.getElementById("enqLinkDelay").disabled = false;
		}
		
	}
	
	function updateEsmes() {
		mbeanSearch="com.telscale.smsc:layer=Esme,name=*";
		var mbeanVar;
		$.ajax({
			dataType: "json",
			url: window.jolokiaProtocol + "//" + window.jolokiaAddress + ":" + window.jolokiaPort + "/jolokia/search/" + mbeanSearch
		})
		.done(function(html) {
			if (html.error) {
				logToConsole("ERROR", html.error);
			}
			else {		
				
				$('.service-row').remove();
				$('.text-info').remove();
				jQuery.each(html.value, function() {
					mbeanVar = this;
					
					
					jolokia.request(
							[
								{ type: "read", mbean: mbeanVar },
							],
							{ success: [
								function(response) {
									
									var host = response.value.Host;
									var port = response.value.Port;
									
									var isSmppServerStarted = response.value.Started;
									
									var name = response.value.Name;
									var clusterName = response.value.ClusterName;
									
									var chargingenabled = response.value.ChargingEnabled;
									
									var esmeTon = response.value.EsmeTon;
									var esmeNpi = response.value.EsmeNpi;
									var esmeAddressRange = response.value.EsmeAddressRange;
									
									var sourceTon = response.value.SourceTon;
									var sourceNpi = response.value.SourceNpi;
									var sourceAddressRange = response.value.SourceAddressRange;
									
									var routingTon = response.value.RoutingTon;
									var routingNpi = response.value.RoutingNpi;
									var routingAddressRange = response.value.RoutingAddressRange;
									
									
									var systemId = response.value.SystemId;
									var localType = response.value.LocalTypeName;
									var state = response.value.StateName;
									
									var systemType = response.value.SystemType;
									var bindType = response.value.BindTypeName;
									var interfaceVersion = response.value.InterfaceVersionName;
									var password = response.value.Password;
									
									var windowSize = response.value.WindowSize;
									var connectTimeout = response.value.ConnectTimeout;
									var requestExpiryTimeout = response.value.RequestExpiryTimeout;
									var windowMonitorInterval = response.value.WindowMonitorInterval;
									var windowWaitTimeout = response.value.WindowWaitTimeout;
									var maxWindowSize = response.value.MaxWindowSize;
									var windowMonitorEnabled = response.value.WindowMonitorEnabled;
									var countersEnabled = response.value.CountersEnabled;
									var enquireLinkDelay = response.value.EnquireLinkDelay;
									
									var boundDuration = response.value.BoundDuration;
									var rxDataSMCounter = response.value.RxDataSMCounter;
									var rxDeliverSMCounter = response.value.RxDeliverSMCounter;
									var rxEnquireLinkCounter = response.value.RxEnquireLinkCounter;
									var rxSubmitSMCounter = response.value.RxSubmitSMCounter;
									var txDataSMCounter = response.value.TxDataSMCounter;
									var txDeliverSMCounter = response.value.TxDeliverSMCounter;
									var txEnquireLinkCounter = response.value.TxEnquireLinkCounter;
									var txSubmitSMCounter = response.value.TxSubmitSMCounter;
									
									var localAddressAndPort = response.value.LocalAddressAndPort;
									var remoteAddressAndPort = response.value.RemoteAddressAndPort;
									var remoteTypeName = response.value.RemoteTypeName;
									
									var bound = response.value.Bound;
									var closed = response.value.Closed;
									var binding = response.value.Binding;
									var unbinding = response.value.Unbinding;	
									
									
									if(systemType == null || systemType==""){
										systemType = "null";
									}
									
									serviceClass = isSmppServerStarted ? 'active-service' : 'inactive-service';
									
									$('#esmes-table').children('tbody').append('<tr class="service-row"><td style="vertical-align: middle; text-align: center;"><i style="color: ' + (isSmppServerStarted ? '#51A351' : '#BD362F') + ';" class="' + (isSmppServerStarted ? 'icon-play-circle' : 'icon-remove-circle') + '"></i></td>'+
											'<td style="cursor: pointer;" onclick="$(this).parent().next().toggle();">' + name + '</td>' +
											'<td style="cursor: pointer;" onclick="$(this).parent().next().toggle();">' + systemId + '</td>' +
											'<td style="cursor: pointer;" onclick="$(this).parent().next().toggle();">' + localType + '</td>' +
											'<td style="cursor: pointer;" onclick="$(this).parent().next().toggle();">' + state + '</td>' +
											'<td style="font-size: 16px; vertical-align: middle; text-align: center; width: 150px;">' + 
												'<button class="btn btn-small btn-success"' + (isSmppServerStarted ? 'disabled' : '') + ' data-toggle="tooltip" title="Start ESME" data-placement="bottom" onclick="esmeOperation(\'startEsme\', \'' + name + '\')"><i class="icon-play"> </i></button> ' +
												'<button class="btn btn-small btn-danger"' + (!isSmppServerStarted ? 'disabled' : '') + ' data-toggle="tooltip" title="Stop ESME" data-placement="bottom" onclick="esmeOperation(\'stopEsme\', \'' + name +  '\')"><i class="icon-stop"> </i></button> ' +
												'<button class="btn btn-small btn-danger"' + (isSmppServerStarted ? 'disabled' : '') + ' data-toggle="tooltip" title="Remove ESME" data-placement="bottom" onclick="esmeOperation(\'destroyEsme\', \'' + name +  '\')"><i class="icon-remove"> </i></button> ' +
												'<a href="#entities-modal'+name+'" role="button" class="btn btn-info btn-small" data-toggle="modal"><i class="icon-external-link"></i></a>' +
											'</td></tr>'+


											'<tr class="text-info" style="display: none;"><td colspan=6>' +
											'<div class="bs-docs-example bs-docs-example-submenus"> '+
									        '    <div>'+
									        '      <p class="muted">SMPP Properties</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
														'<dt>ClusterName</dt> <dd>' + clusterName + ' </dd>' + 
														'<dt>SystemType</dt> <dd>' + systemType + ' </dd>' + 
														'<dt>BindType</dt> <dd>' + bindType + ' </dd>' + 
														'<dt>InterfaceVersion</dt> <dd>' + interfaceVersion + ' </dd>' + 
														'<dt>Password</dt> <dd>' + password + ' </dd>' + 
													'</dl>'+
									        '    </div>'+
									        
							        		'<hr style="margin: 5px 0;"/>' +
									        '    <div>'+
									        '      <p class="muted">Charging</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
														'<dt>ChargingEnabled</dt> <dd>' + chargingenabled + ' </dd>' +
													'</dl>'+
									        '    </div>'+				        		
									        
									        
								        		'<hr style="margin: 5px 0;"/>' +
										        '    <div>'+
										        '      <p class="muted">ESME Address</p>'+
														'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
															'<dt>TypeOfNumber</dt> <dd>' + esmeTon + ' </dd>' +
															'<dt>NumberPlanIndicator</dt> <dd>' + esmeNpi + ' </dd>' +
															'<dt>AddressRange</dt> <dd>' + esmeAddressRange + ' </dd>' +
														'</dl>'+
										        '    </div>'+	

								        		'<hr style="margin: 5px 0;"/>' +
										        '    <div>'+
										        '      <p class="muted">Source Address</p>'+
														'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
															'<dt>TypeOfNumber</dt> <dd>' + sourceTon + ' </dd>' +
															'<dt>NumberPlanIndicator</dt> <dd>' + sourceNpi + ' </dd>' +
															'<dt>AddressRange</dt> <dd>' + sourceAddressRange + ' </dd>' +
														'</dl>'+
										        '    </div>'+
										        
								        		'<hr style="margin: 5px 0;"/>' +
										        '    <div>'+
										        '      <p class="muted">Routing Address</p>'+
														'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
															'<dt>TypeOfNumber</dt> <dd>' + routingTon + ' </dd>' +
															'<dt>NumberPlanIndicator</dt> <dd>' + routingNpi + ' </dd>' +
															'<dt>AddressRange</dt> <dd>' + routingAddressRange + ' </dd>' +
														'</dl>'+
										        '    </div>'+											        
										        
									        	'<hr style="margin: 5px 0;"/>' +
									        '    <div>'+
									        '      <p class="muted">Configuration</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
														'<dt>ConnectTimeout</dt> <dd>' + connectTimeout + ' </dd>' +
														'<dt>WindowSize</dt> <dd>' + windowSize + ' </dd>' +
														'<dt>RequestExpiryTimeout</dt> <dd>' + requestExpiryTimeout + ' </dd>' +
														'<dt>WindowMonitorInterval</dt> <dd>' + windowMonitorInterval + ' </dd>' +
														'<dt>WindowWaitTimeout</dt> <dd>' + windowWaitTimeout + ' </dd>' +
														'<dt>MaxWindowSize</dt> <dd>' + maxWindowSize + ' </dd>' +
														'<dt>WindowMonitorEnabled</dt> <dd>' + windowMonitorEnabled + ' </dd>' +
														'<dt>CountersEnabled</dt> <dd>' + countersEnabled + ' </dd>' +
														'<dt>EnquireLinkDelay</dt> <dd>' + enquireLinkDelay + ' </dd>' +
													'</dl>'+
									        '    </div>'+	
									        '<hr style="margin: 5px 0;"/>' +
									        '    <div>'+
									        '      <p class="muted">Statistics</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
													'<dt>BoundDuration</dt> <dd>' + boundDuration + ' </dd>' +
													'<dt>RxDataSMCounter</dt> <dd>' + rxDataSMCounter + ' </dd>' +
													'<dt>RxDeliverSMCounter</dt> <dd>' + rxDeliverSMCounter + ' </dd>' +
													'<dt>RxEnquireLinkCounter</dt> <dd>' + rxEnquireLinkCounter + ' </dd>' +
													'<dt>RxSubmitSMCounter</dt> <dd>' + rxSubmitSMCounter + ' </dd>' +
													'<dt>TxDataSMCounter</dt> <dd>' + txDataSMCounter + ' </dd>' +
													'<dt>TxDeliverSMCounter</dt> <dd>' + txDeliverSMCounter + ' </dd>' +
													'<dt>TxEnquireLinkCounter</dt> <dd>' + txEnquireLinkCounter + ' </dd>' +
													'<dt>TxSubmitSMCounter</dt> <dd>' + txSubmitSMCounter + ' </dd>' +
													'</dl>'+
									        '    </div>'+
									        '<hr style="margin: 5px 0;"/>' +
									        '    <div>'+
									        '      <p class="muted">Various</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
													'<dt>ConfiguredAddressAndPort</dt> <dd>' + host +':'+ port + ' </dd>' +
													'<dt>LocalAddressAndPort</dt> <dd>' + localAddressAndPort + ' </dd>' +
													'<dt>RemoteAddressAndPort</dt> <dd>' + remoteAddressAndPort + ' </dd>' +
													'<dt>RemoteTypeName</dt> <dd>' + remoteTypeName + ' </dd>' +
													'</dl>'+
									        '    </div>'+	
									        '<hr style="margin: 5px 0;"/>' +
									        '    <div>'+
									        '      <p class="muted">State</p>'+
													'<dl class="dl-horizontal" style="font-size: 0.8em;">' +
													'<dt>Bound</dt> <dd>' + bound + ' </dd>' +
													'<dt>Closed</dt> <dd>' + closed + ' </dd>' +
													'<dt>Binding</dt> <dd>' + binding + ' </dd>' +
													'<dt>Unbinding</dt> <dd>' + unbinding + ' </dd>' +
													'</dl>'+
									        '    </div>'+	
									        '<hr style="margin: 5px 0;"/>' +
									        '<div class="btn-group">'+
									        '              <button type="button" class="btn" onclick="disableLogBytes(\'' + name +  '\')"><i class="icon-ban-circle"></i> DisableLogBytes</button>'+
									        '              <button type="button" class="btn" onclick="disableLogPdu(\'' + name +  '\')"><i class="icon-ban-circle"></i> DisableLogPdu</button>'+
									        '              <button type="button" class="btn" onclick="dumpWindow(\'' + name +  '\')"><i class="icon-comment-alt"></i> DumpWindow</button>'+
									        '              <button type="button" class="btn" onclick="enableLogBytes(\'' + name +  '\')"><i class="icon-check"></i> EnableLogBytes</button>'+
									        '              <button type="button" class="btn" onclick="enableLogPdu(\'' + name +  '\')"><i class="icon-check"></i> EnableLogPdu</button>'+
									        '              <button type="button" class="btn" onclick="resetCounters(\'' + name +  '\')"><i class="icon-spinner"></i> ResetCounters</button>'+
									        '            </div>'+
									 		'</div>'+
									 		
											'</td></tr>'
									);	
									
									$('#esmes-table-wrapper').append('<div id="entities-modal'+name+'" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">'+
											'<div class="modal-header">'+
												'<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+
												'<h3>ESME '+name+' properties</h3>'+
											'</div>'+	
											'<div id="entities-modal-body" class="modal-body">'+
													'<div class="accordion-group">' +
														'<div class="accordion-heading">' +name+ 										
														'</div>'+
														'<div id="' + name + '" class="accordion-body">' +
															'<div class="accordion-inner">' +
																'<strong><i class="icon-list"></i> ESME Configuration Properties</strong>' +
																
																'<div class="alert alert-error" id="login-settings-error" style="display:none;">'+
																  '<button type="button" class="close">&times;</button>'+
																  'Some Fields are not correctly filled out, please double check the settings below !'+
																'</div>'+																			
																
																'<table class="table table-condensed table-striped">' + 
																	'<thead><tr><th style="width: 40%;">Name</th><th style="width: 55%;">Value</th><th>&nbsp;</th></tr></thead>' +
																	'<tbody>'+
																		'<tr data-toggle="tooltip" title="esme TON">'+
																			'<td style="font-size: 0.9em;">ESME TON</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'SystemId-input" class="control-group">'+
																				'<span id="' + name +'SystemId-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + esmeTon + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'EsmeTon\', \'' + name+"SystemId" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"SystemId"+']\').toggle(); $(\'input[id^='+name+"SystemId"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'SystemId-text">' + esmeTon + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"SystemId"+']\').toggle(); $(\'input[id^='+name+"SystemId"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="esme NPI">'+
																			'<td style="font-size: 0.9em;">ESME NPI</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'EsmeNpi-input" class="control-group">'+
																				'<span id="' + name +'EsmeNpi-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + esmeNpi + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'EsmeNpi\', \'' + name+"EsmeNpi" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"EsmeNpi"+']\').toggle(); $(\'input[id^='+name+"EsmeNpi"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'EsmeNpi-text">' + esmeNpi + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"EsmeNpi"+']\').toggle(); $(\'input[id^='+name+"EsmeNpi"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="esme Address Range">'+
																			'<td style="font-size: 0.9em;">ESME Address Range</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'EsmeAddressRange-input" class="control-group">'+
																				'<span id="' + name +'EsmeAddressRange-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + esmeAddressRange + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'EsmeAddressRange\', \'' + name+"EsmeAddressRange" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"EsmeAddressRange"+']\').toggle(); $(\'input[id^='+name+"EsmeAddressRange"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'EsmeAddressRange-text">' + esmeAddressRange + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"EsmeAddressRange"+']\').toggle(); $(\'input[id^='+name+"EsmeAddressRange"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="window size">'+
																			'<td style="font-size: 0.9em;">Window Size</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'WindowSize-input" class="control-group">'+
																				'<span id="' + name +'WindowSize-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + windowSize + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'WindowSize\', \'' + name+"WindowSize" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowSize"+']\').toggle(); $(\'input[id^='+name+"WindowSize"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'WindowSize-text">' + windowSize + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowSize"+']\').toggle(); $(\'input[id^='+name+"WindowSize"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Connect Timeout">'+
																			'<td style="font-size: 0.9em;">Connect Timeout</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'ConnectTimeout-input" class="control-group">'+
																				'<span id="' + name +'ConnectTimeout-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + connectTimeout + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'ConnectTimeout\', \'' + name+"ConnectTimeout" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"ConnectTimeout"+']\').toggle(); $(\'input[id^='+name+"ConnectTimeout"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'ConnectTimeout-text">' + connectTimeout + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"ConnectTimeout"+']\').toggle(); $(\'input[id^='+name+"ConnectTimeout"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Request Expiry Timeout">'+
																			'<td style="font-size: 0.9em;">Request Expiry Timeout</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'RequestExpiryTimeout-input" class="control-group">'+
																				'<span id="' + name +'RequestExpiryTimeout-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + requestExpiryTimeout + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'RequestExpiryTimeout\', \'' + name+"RequestExpiryTimeout" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"RequestExpiryTimeout"+']\').toggle(); $(\'input[id^='+name+"RequestExpiryTimeout"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'RequestExpiryTimeout-text">' + requestExpiryTimeout + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"RequestExpiryTimeout"+']\').toggle(); $(\'input[id^='+name+"RequestExpiryTimeout"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Window Monitor Interval">'+
																			'<td style="font-size: 0.9em;">Window Monitor Interval</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'WindowMonitorInterval-input" class="control-group">'+
																				'<span id="' + name +'WindowMonitorInterval-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + windowMonitorInterval + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'WindowMonitorInterval\', \'' + name+"WindowMonitorInterval" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowMonitorInterval"+']\').toggle(); $(\'input[id^='+name+"WindowMonitorInterval"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'WindowMonitorInterval-text">' + windowMonitorInterval + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowMonitorInterval"+']\').toggle(); $(\'input[id^='+name+"WindowMonitorInterval"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Window Wait Timeout">'+
																			'<td style="font-size: 0.9em;">Window Wait Timeout</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'WindowWaitTimeout-input" class="control-group">'+
																				'<span id="' + name +'WindowWaitTimeout-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + windowWaitTimeout + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'WindowWaitTimeout\', \'' + name+"WindowWaitTimeout" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowWaitTimeout"+']\').toggle(); $(\'input[id^='+name+"WindowWaitTimeout"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'WindowWaitTimeout-text">' + windowWaitTimeout + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"WindowWaitTimeout"+']\').toggle(); $(\'input[id^='+name+"WindowWaitTimeout"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Counters Enabled">'+
																			'<td style="font-size: 0.9em;">Counters Enabled</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'CountersEnabled-input" class="control-group">'+
																				'<span id="' + name +'CountersEnabled-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + countersEnabled + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'CountersEnabled\', \'' + name+"CountersEnabled" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"CountersEnabled"+']\').toggle(); $(\'input[id^='+name+"CountersEnabled"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'CountersEnabled-text">' + countersEnabled + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"CountersEnabled"+']\').toggle(); $(\'input[id^='+name+"CountersEnabled"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Enquire Link Delay">'+
																			'<td style="font-size: 0.9em;">Enquire Link Delay</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'EnquireLinkDelay-input" class="control-group">'+
																				'<span id="' + name +'EnquireLinkDelay-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + enquireLinkDelay + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'EnquireLinkDelay\', \'' + name+"EnquireLinkDelay" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"EnquireLinkDelay"+']\').toggle(); $(\'input[id^='+name+"EnquireLinkDelay"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'EnquireLinkDelay-text">' + enquireLinkDelay + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"EnquireLinkDelay"+']\').toggle(); $(\'input[id^='+name+"EnquireLinkDelay"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Charging Enabled">'+
																			'<td style="font-size: 0.9em;">Charging Enabled</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'ChargingEnabled-input" class="control-group">'+
																				'<span id="' + name +'ChargingEnabled-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + chargingenabled + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'ChargingEnabled\', \'' + name+"ChargingEnabled" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"ChargingEnabled"+']\').toggle(); $(\'input[id^='+name+"ChargingEnabled"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'ChargingEnabled-text">' + chargingenabled + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"ChargingEnabled"+']\').toggle(); $(\'input[id^='+name+"ChargingEnabled"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Source Ton">'+
																			'<td style="font-size: 0.9em;">Source Ton</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'SourceTon-input" class="control-group">'+
																				'<span id="' + name +'SourceTon-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + sourceTon + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'SourceTon\', \'' + name+"SourceTon" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceTon"+']\').toggle(); $(\'input[id^='+name+"SourceTon"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'SourceTon-text">' + sourceTon + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceTon"+']\').toggle(); $(\'input[id^='+name+"SourceTon"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Source Npi">'+
																			'<td style="font-size: 0.9em;">Source Npi</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'SourceNpi-input" class="control-group">'+
																				'<span id="' + name +'SourceNpi-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + sourceNpi + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'SourceNpi\', \'' + name+"SourceNpi" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceNpi"+']\').toggle(); $(\'input[id^='+name+"SourceNpi"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'SourceNpi-text">' + sourceNpi + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceNpi"+']\').toggle(); $(\'input[id^='+name+"SourceNpi"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Source Address Range">'+
																			'<td style="font-size: 0.9em;">Source Address Range</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'SourceAddressRange-input" class="control-group">'+
																				'<span id="' + name +'SourceAddressRange-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + sourceAddressRange + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'SourceAddressRange\', \'' + name+"SourceAddressRange" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceAddressRange"+']\').toggle(); $(\'input[id^='+name+"SourceAddressRange"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'SourceAddressRange-text">' + sourceAddressRange + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"SourceAddressRange"+']\').toggle(); $(\'input[id^='+name+"SourceAddressRange"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Routing Ton">'+
																			'<td style="font-size: 0.9em;">Routing Ton</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'RoutingTon-input" class="control-group">'+
																				'<span id="' + name +'RoutingTon-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + routingTon + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'RoutingTon\', \'' + name+"RoutingTon" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingTon"+']\').toggle(); $(\'input[id^='+name+"RoutingTon"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'RoutingTon-text">' + routingTon + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingTon"+']\').toggle(); $(\'input[id^='+name+"RoutingTon"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	
																		
																		'<tr data-toggle="tooltip" title="Routing Npi">'+
																			'<td style="font-size: 0.9em;">Routing Npi</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'RoutingNpi-input" class="control-group">'+
																				'<span id="' + name +'RoutingNpi-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + routingNpi + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'RoutingNpi\', \'' + name+"RoutingNpi" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingNpi"+']\').toggle(); $(\'input[id^='+name+"RoutingNpi"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'RoutingNpi-text">' + routingNpi + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingNpi"+']\').toggle(); $(\'input[id^='+name+"RoutingNpi"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Routing Address Range">'+
																			'<td style="font-size: 0.9em;">Routing Address Range</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + name +'RoutingAddressRange-input" class="control-group">'+
																				'<span id="' + name +'RoutingAddressRange-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + routingAddressRange + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + name+ '\', \'RoutingAddressRange\', \'' + name+"RoutingAddressRange" + '\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingAddressRange"+']\').toggle(); $(\'input[id^='+name+"RoutingAddressRange"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +name + 'RoutingAddressRange-text">' + routingAddressRange + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+name+"RoutingAddressRange"+']\').toggle(); $(\'input[id^='+name+"RoutingAddressRange"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																	'</tbody>' +
																'</table>' +															
															'</div>'+
														'</div>'+
													'</div>'+
											'</div>'+
											'<div class="modal-footer">'+
												'<a href="#" onclick="$(\'#entities-modal'+name+'\').modal(\'hide\'); return false;" class="btn">Close</a>'+
											'</div>'+										
										'</div>');											
									
								}],
								error: function(value){
									errorUID = ("st" + new Date().getTime()).hashCode();
									createStackTrace(errorUID, value.stacktrace);
									logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
								}
							}
						); 

				});
			}
		})
		.fail(function() {
			logToConsole("ERROR", "Failure trying to communicate with the SMSC Gateway. Please try again later.");
		})
	}
	function disableLogBytes(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"disableLogBytes",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully disabled log bytes for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}
	function disableLogPdu(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"disableLogPdu",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully disabled log pdu for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}	
	function dumpWindow(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"dumpWindow",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully dumped window for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}
	function enableLogBytes(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"enableLogBytes",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully enabled log bytes for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}	
	function enableLogPdu(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"enableLogPdu",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully enabled log pdu for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}	
	function resetCounters(esmeName){
		mbeanSearch="com.telscale.smsc:layer=Esme,name="+esmeName;
		jolokia.execute(mbeanSearch,"resetCounters",
				{
					success: function(value) {
						logToConsole('INFO', 'Successfully resetted counters for Esme ' + esmeName );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
	}	
	function esmeOperation(operation, name) {
		mbeanSearch="com.telscale.smsc:layer=EsmeManagement,name=SmscManagement";
		jolokia.execute(mbeanSearch,operation,name,
				{
					success: function(value) {
						updateEsmes();
						logToConsole('INFO', 'Successfully '+operation+'ed Esme ' + name );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
		
	}
	function createEsme(){
		var formInvalid = false;
		var focusNotSet = true;
		
		var esmeName = $("#esmeName").val();
		if(esmeName.trim() == "") {
			$("#div-esmeName").addClass("error");
			if(focusNotSet){
				$("#esmeName").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-esmeName").hasClass("error")) {
			$("#div-esmeName").removeClass("error");		
		}
		
		var systemId = $("#systemId").val();
		if(systemId.trim() == "") {
			$("#div-systemId").addClass("error");
			if(focusNotSet){
				$("#systemId").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-systemId").hasClass("error")) {
			$("#div-systemId").removeClass("error");		
		}
		
		var password = $("#password").val();
		if(password.trim() == "") {
			$("#div-password").addClass("error");		
			if(focusNotSet){
				$("#password").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-password").hasClass("error")) {
			$("#div-password").removeClass("error");		
		}
		
		var ipAddress = $("#ipAddress").val();
		if(ipAddress.trim() == "") {
			$("#div-ipAddress").addClass("error");		
			if(focusNotSet){
				$("#ipAddress").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-ipAddress").hasClass("error")) {
			$("#div-ipAddress").removeClass("error");		
		}
		
		var ipPort = $("#ipPort").val();
		if(ipPort.trim() == "") {
			$("#div-ipPort").addClass("error");		
			if(focusNotSet){
				$("#ipPort").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-ipPort").hasClass("error")) {
			$("#div-ipPort").removeClass("error");		
		}

		var e = document.getElementById("smppBindType");
		var smppBindType = e.options[e.selectedIndex].text;
		
		var e1 = document.getElementById("smppSessionType");
		var smppSessionType = e1.options[e1.selectedIndex].text;		
		
		var systemType = $("#systemType").val();
		
		
		var e2 = document.getElementById("version");
		var smppVersion = e2.options[e2.selectedIndex].text;	
		
		var e3 = document.getElementById("esmeTon");
		var esmeTon = e3.options[e3.selectedIndex].value;	
		
		var e4 = document.getElementById("esmeNpi");
		var esmeNpi = e4.options[e4.selectedIndex].value;
		
		var esmeRange = $("#esmeRange").val();
		
		var e7 = document.getElementById("sourceTon");
		var sourceTon = e7.options[e7.selectedIndex].value;	
		
		var e8 = document.getElementById("sourceNpi");
		var sourceNpi = e8.options[e8.selectedIndex].value;
		
		var sourceRange = $("#sourceRange").val();
		
		
		var e9 = document.getElementById("routingTon");
		var routingTon = e9.options[e9.selectedIndex].value;	
		
		var e10 = document.getElementById("routingNpi");
		var routingNpi = e10.options[e10.selectedIndex].value;
		
		var routingRange = $("#routingRange").val();		
		
		
		var clusterName = $("#clusterName").val();
		
		if(clusterName.trim() == ""){
			clusterName = esmeName;
		}
		
		var windowSize = $("#windowSize").val();
		
		if(windowSize == null){
			windowSize = "1";//SmppConstants.DEFAULT_WINDOW_SIZE
		}

		var connectTimeout = $("#connectTimeout").val();
		if(connectTimeout == null){
			connectTimeout = "10000";
		}
		
		var reqExpTimeout = $("#reqExpTimeout").val();
		if(reqExpTimeout == null){
			reqExpTimeout = "-1";
		}
		
		var windowMonitorInterval = $("#windowMonitorInterval").val();
		if(windowMonitorInterval == null){
			windowMonitorInterval = "-1";
		}
		
		var windowWaitTimeout = $("#windowWaitTimeout").val();
		if(windowWaitTimeout == null){
			windowWaitTimeout = "60000";
		}
		
		var e5 = document.getElementById("countersEnabled");
		var countersEnabled = e5.options[e5.selectedIndex].text;	
		
		var enqLinkDelay = $("#enqLinkDelay").val();
		if(enqLinkDelay == null){
			enqLinkDelay = "30000";
		}
		
		var e6 = document.getElementById("chargingEnabled");
		var chargingEnabled = e6.options[e5.selectedIndex].text;
		
		if(formInvalid) {
			$("#login-settings-error").show();
			logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
			return false;
		} else {
			$("#login-settings-error").hide();
		}
		
		jolokia.execute("com.telscale.smsc:layer=EsmeManagement,name=SmscManagement","createEsme", esmeName,systemId,password,ipAddress,ipPort,chargingEnabled,smppBindType,systemType,smppVersion,esmeTon,esmeNpi,esmeRange,smppSessionType,windowSize,connectTimeout,reqExpTimeout,windowMonitorInterval,windowWaitTimeout,clusterName,countersEnabled,enqLinkDelay,sourceTon,sourceNpi,sourceRange,routingTon,routingNpi,routingRange, 
				{
					success: function(value) {
						updateEsmes();
						logToConsole('INFO', 'ESME ' + esmeName + ' created successfuly.');
						$('#entities-modal').modal('hide');
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}					
				});		
		
	}
	function onModifyEsmeOk(mbeanName, propertyName, spanId){
		var formInvalid = false;
		
		var spanElement = document.getElementById(spanId + "-input");
		var eleChild = spanElement.childNodes;
		var inputTextEle = eleChild[0];
		var spanElementTxt = document.getElementById(spanId + "-text");
		
		var propvalue = inputTextEle.value;
		
		if(propvalue.trim() == "") {
			$("#div-"+spanId + "-input").addClass("error");					    			
			formInvalid = true;
		} else if($("#div-"+spanId + "-input").hasClass("error")) {
			$("#div-"+spanId + "-input").removeClass("error");		
		}	
		
		if(formInvalid) {
			$("#login-settings-error").show();
			logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
			return false;
		} else {
			$("#login-settings-error").hide();
		}					
		
		var mbeanSearch="com.telscale.smsc:layer=Esme,name="+mbeanName;
		jolokia.request(
				[
					{ type: "write", mbean: mbeanSearch, attribute: propertyName, value: inputTextEle.value },
				],
				{
					success: function(response) {
						
						logToConsole("INFO", "ESME property "+ propertyName +"  successfully updated.");
						
						spanElementTxt.innerHTML= inputTextEle.value;
					},
					error: function(value) {
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					} 
				}
			);		
		
		spanElement.style.display = 'none';
		spanElementTxt.style.display = '';
		
		
	}	
	$(document).ready(function () {
		updateEsmes();
	});
</script>
